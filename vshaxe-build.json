{
	"inherit": "vshaxe-node",
	"mainTarget": "language-server",
	"haxelibs": [
		{
			"name": "haxe-hxparser",
			"installArgs": ["git", "haxe-hxparser", "https://github.com/vshaxe/haxe-hxparser"],
			"includeProjectFile": true
		},
		{
			"name": "utest",
			"installArgs": ["install", "utest"]
		},
		{
			"name": "hxparse",
			"installArgs": ["git", "hxparse", "https://github.com/Simn/hxparse", "--never"]
		},
		{
			"name": "haxeparser",
			"installArgs": ["git", "haxeparser", "https://github.com/Simn/haxeparser", "--never"]
		},
		{
			"name": "tokentree",
			"installArgs": ["git", "tokentree", "https://github.com/HaxeCheckstyle/tokentree"]
		},
		{
			"name": "formatter",
			"installArgs": ["git", "formatter", "https://github.com/HaxeCheckstyle/haxe-formatter"]
		},
		{
			"name": "json2object",
			"installArgs": ["install", "json2object"]
		},
		{
			"name": "json-rpc",
			"installArgs": ["git", "json-rpc", "https://github.com/vshaxe/json-rpc"]
		},
		{
			"name": "uglifyjs",
			"installArgs": ["install", "uglifyjs"]
		}
	],
	"targets": [
		{
			"name": "language-server",
			"args": {
				"haxelibs": ["haxe-hxparser", "hxparse", "haxeparser", "tokentree", "formatter", "json2object", "json-rpc", "uglifyjs"],
				"classPaths": [
					"src",
					"protocol/src"
				],
				"defines": [
					"JSTACK_FORMAT=vscode",
					"uglifyjs_overwrite"
				],
				"output": {
					"target": "js",
					"path": "bin/server.js"
				},
				"macros": [
					"haxeLanguageServer.Init.run()"
				],
				"deadCodeElimination": "full",
				"main": "haxeLanguageServer.Main"
			}
		},
		{
			"name": "language-server-tests",
			"args": {
				"haxelibs": ["haxe-hxparser", "hxparse", "haxeparser", "tokentree", "formatter", "json2object", "json-rpc", "utest"],
				"classPaths": [
					"src",
					"test",
					"protocol/src"
				],
				"output": {
					"target": "js",
					"path": "bin/test.js"
				},
				"deadCodeElimination": "full",
				"main": "TestMain",
				"debug": true
			},
			"afterBuildCommands": [
				["node", "bin/test.js"]
			]
		}
	]
}