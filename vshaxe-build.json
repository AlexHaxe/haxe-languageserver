{
    "inherit": "vshaxe-node",
    "mainTarget": "language-server",
    "haxelibs": [
        {
            "name": "haxe-hxparser",
            "installArgs": ["git", "haxe-hxparser", "https://github.com/vshaxe/haxe-hxparser"],
            "includeProjectFile": true
        },
        {
            "name": "compiletime",
            "installArgs": ["install", "compiletime"]
        },
        {
            "name": "hx3compat",
            "installArgs": ["install", "hx3compat"]
        }
    ],
    "targets": [
        {
            "name": "language-server",
            "args": {
                "haxelibs": ["haxe-hxparser"],
                "classPaths": [
                    "src",
                    "protocol/src",
                    "formatter/src"
                ],
                "defines": [
                    "JSTACK_FORMAT=vscode"
                ],
                "output": {
                    "target": "js",
                    "path": "bin/server.js"
                },
                "deadCodeElimination": "full",
                "main": "haxeLanguageServer.Main"
            }
        },
        {
            "name": "language-server-tests",
            "args": {
                "haxelibs": ["haxe-hxparser", "compiletime", "hx3compat"],
                "classPaths": [
                    "src",
                    "test",
                    "protocol/src",
                    "formatter/src"
                ],
                "output": {
                    "target": "js",
                    "path": "bin/test.js"
                },
                "deadCodeElimination": "full",
                "main": "TestMain",
                "debug": true
            },
            "afterBuildCommands": [
                ["node", "bin/test.js"]
            ]
        }
    ]
}